@page
@model CustomerSalesSystem.Web.Pages.Sales.CreateModel
@inject ProductService _productService;
@inject CustomerService _customerService;
@{
    ViewData["Title"] = "Create Sale";
}

<h2>Create Sale</h2>

@{
    var customers = await _customerService.GetAllAsync(1, 50);
    IList<CustomerDto> Customers = customers.Items;
    IList<ProductDto>  Products = await _productService.GetAllAsync();
}
<div class="row justify-content-center">
    <div class="col-md-6 card shadow-sm p-3">
        <form method="post">
            <!-- Validation Summary -->
            <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

            <div class="mb-3">
                <label asp-for="Sale.CustomerId" class="form-label">Customer</label>
                <select asp-for="Sale.CustomerId" class="form-select" required>
                    <option value="">Select customer</option>
                    @foreach (var c in Customers)
                    {
                        <option value="@c.Id">@c.Name</option>
                    }
                </select>
                <span asp-validation-for="Sale.CustomerId" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Sale.ProductId" class="form-label">Product</label>
                <select asp-for="Sale.ProductId" class="form-select" required>
                    <option value="">Select product</option>
                    @foreach (var p in Products)
                    {
                        <option value="@p.Id">@p.Name</option>
                    }
                </select>
                <span asp-validation-for="Sale.ProductId" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Sale.Quantity" class="form-label">Quantity</label>
                <input asp-for="Sale.Quantity" class="form-control" min="1" required />
                <span asp-validation-for="Sale.Quantity" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Sale.SaleDate" class="form-label">Sale Date</label>
                <input asp-for="Sale.SaleDate" type="date" value="@DateTime.Now" class="form-control" required />
                <span asp-validation-for="Sale.SaleDate"  class="text-danger"></span>
            </div>

            <button type="submit" class="btn btn-primary">Create Sale</button>
            <a asp-page="@PageNavigation.SalesList" class="btn btn-secondary">Cancel</a>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
